<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Order History — Warm Vibe Bistro</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;0,900;1,400;1,700&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet">
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/order_history.css' %}">
</head>
<body>

<!-- NAV -->
<nav class="site-nav">
  <a href="/" class="nav-logo">Warm Vibe Bistro</a>
  <div class="nav-links">
    <a href="{% url 'menu:menu' %}">Menu</a>
    <a href="{% url 'reservations:reservation' %}">Reservations</a>
    <a href="{% url 'orders:cart' %}" class="nav-cta">Cart</a>
  </div>
</nav>

<!-- PAGE HEADER -->
<div class="page-header">
  <div class="header-eyebrow">Your Account</div>
  <h1>Order <em>History</em></h1>
</div>

<div class="container">
  <a href="{% url 'menu:menu' %}" class="back">← Back to Menu</a>
  <!-- Email lookup form -->
<div class="lookup-card">
  <div class="section-label">Find Your Orders</div>
  <p class="lookup-sub">Enter the email address you used when placing your order.</p>
  <form method="GET" class="lookup-form">
    <input
      type="email"
      name="email"
      placeholder="your@email.com"
      value="{{ email_query }}"
      required
    >
    <button type="submit">Look Up →</button>
  </form>
</div>

  {% if orders %}
    <div class="orders-list">
      {% for order in orders %}
        <div class="order-card">

          <!-- Card Header -->
          <div class="order-card-header">
            <div class="order-meta">
              <span class="order-number">#{{ order.order_number|stringformat:"s"|slice:":8"|upper }}</span>
              <span class="order-date">{{ order.created_at|date:"F j, Y — g:i A" }}</span>
            </div>
            <span class="status-badge status-{{ order.status }}">{{ order.get_status_display }}</span>
          </div>

          <!-- Items -->
          <div class="order-items">
            <div class="section-label">Items Ordered</div>
            {% for item in order.items.all %}
              <div class="order-item">
                <span class="item-name">{{ item.quantity }}× {{ item.name }}</span>
                <span class="item-price">${{ item.item_total }}</span>
              </div>
            {% endfor %}
          </div>

          <!-- Footer -->
          <div class="order-card-footer">
            <div class="pickup-info">
              <span class="pickup-label">Pickup</span>
              <span class="pickup-time">{{ order.pickup_time|date:"M j, Y" }} at {{ order.pickup_time|time:"g:i A" }}</span>
            </div>
            <div class="order-total">
              <span class="total-label">Total</span>
              <span class="total-amount">${{ order.total }}</span>
            </div>
          </div>

        </div>
      {% endfor %}
    </div>

  {% else %}
    <div class="empty-state">
      <p class="empty-title">No orders yet</p>
      <p class="empty-sub">Your order history will appear here once you've placed an order.</p>
      <a href="{% url 'menu:menu' %}" class="btn-order">Browse the Menu →</a>
    </div>
  {% endif %}
</div>

</body>
</html>